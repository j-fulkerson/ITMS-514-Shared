---
title: "Final Project ITMS-514"
author: "Group 13"
date: "Due Date 11/26"
output: html_document
---

# California Avocado Production 1980-2020

## About Dataset
Parts of California has the right weather conditions to produce a lot of avocados. This data consist of 40 years of California Avocado production by county per year.

In this dataset you will find the annual amount of acres harvested, yield, production, price per unit, total value by county.

This data could be used to practice data visualization, data cleaning, forecasting

The data is from USDA's National Agricultural Statistics Service California Field Office (Part of the Pacific Regional Field Office).

```{r echo=FALSE, message=FALSE }
# add packages you need for this assignment
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,comment = '', fig.width = 3, fig.height = 3
  )
```

```{r echo=FALSE}
raw_data <- read.csv("cali_avocados.csv")
avocado_data <- data.frame(raw_data)
```



## Data Preperation

**Observations of the Dataset**
```{r}
str(avocado_data)
summary(avocado_data)
```
 



## Missing values

**Year**
```{r echo=FALSE}
which(is.na(avocado_data$Year))
sum(is.na(avocado_data$Year))
```
**Commodity Code**
```{r echo=FALSE}
which(is.na(avocado_data$Commodity.Code))
sum(is.na(avocado_data$Commodity.Code))
```
**Crop Name**
```{r echo=FALSE}
which(is.na(avocado_data$Crop.Name))
sum(is.na(avocado_data$Crop.Name))
```
**County Code**
```{r echo=FALSE}
which(is.na(avocado_data$County.Code))
sum(is.na(avocado_data$County.Code))
```
**County**
```{r echo=FALSE}
which(is.na(avocado_data$County))
sum(is.na(avocado_data$County))
```
**Harvest Acres**
```{r echo=FALSE}
which(is.na(avocado_data$Harvested.Acres))
sum(is.na(avocado_data$Harvested.Acres))
```
**Yield**
```{r echo=FALSE}
which(is.na(avocado_data$Yield))
sum(is.na(avocado_data$Yield))
```
**Production**
```{r echo=FALSE}
which(is.na(avocado_data$Production))
sum(is.na(avocado_data$Production))
```
**Price.Pu**
```{r echo=FALSE} 
which(is.na(avocado_data$Price.P.U))
sum(is.na(avocado_data$Price.P.U))
```
**Value**
```{r echo=FALSE}
which(is.na(avocado_data$Value))
sum(is.na(avocado_data$Value))
```
**TOTAL**
```{r}
which(is.na(avocado_data))
sum(is.na(avocado_data))
```




## Histogram

**Harvested Acres**
```{r}
hist(avocado_data$Harvested.Acres)
```

**Yield**
```{r}
hist(avocado_data$Yield)
```
**Production**
```{r}
hist(avocado_data$Production)
```
**Price P/U**
```{r}
hist(avocado_data$Price.P.U)
```
**Value**
```{r}
hist(avocado_data$Value)
```



## Hypothesis Test

**Price mean**
```{r}
price_mean <- mean(avocado_data$Price.P.U, na.rm = TRUE)
print(price_mean)
```
**Price Mean for small and large harvests**
```{r}
harvest_mean <- mean(avocado_data$Harvested.Acres, na.rm = TRUE)
small_harvest <- subset.data.frame(avocado_data, avocado_data$Harvested.Acres < harvest_mean)
small_harvest_price_mean <- mean(small_harvest$Price.P.U, na.rm = TRUE)
print(small_harvest_price_mean)

large_harvest <- subset.data.frame(avocado_data, avocado_data$Harvested.Acres > harvest_mean)
large_harvest_price_mean <- mean(large_harvest$Price.P.U, na.rm = TRUE)
```

> The amount of acres being harvested does not affect the price per unit of avocados 

**t-test**
```{r}
t.test(x = avocado_data$Price.P.U, mu = small_harvest_price_mean)

t.test(x = avocado_data$Price.P.U, mu = large_harvest_price_mean)
```





## Linear Regression Model

```{r}
acres_production_lm <- lm(Harvested.Acres ~ Production, data = avocado_data)
summary(acres_production_lm)
```
**Must Generate Plots to visualize regression**
